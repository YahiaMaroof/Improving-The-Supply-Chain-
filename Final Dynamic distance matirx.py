import googlemaps
import pandas as pd

# ğŸ” Ø£Ø¯Ø®Ù„ Ù…ÙØªØ§Ø­ Google Maps API Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù‡Ù†Ø§
API_KEY = "AIzaSyBmOW3KV_OtHWWstqDRPQBUVUCXP4E9Ua8"
gmaps = googlemaps.Client(key=API_KEY)

# ğŸ·ï¸ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†
supplier_names = [
     "Ø§Ù„Ù…Ø®Ø²Ù†",
     "Ø§Ù„ÙˆÙƒØ§Ù„Ù‡ Ù„Ù„Ø³ÙŠØ§Ø±Ø§Øª",
     "Ø±ÙˆØ§Ø³ÙŠ",
     "Ù†Ø¬Ù… Ø§Ù„Ø±Ù…Ø§Ù„",
     "Ø§Ù„ØºÙÙŠÙ„ÙŠ",
     "Ø§Ù„Ø´Ø±Ù‚",
     "Ø±ÙƒÙ† Ø§Ù„Ø±Ø§Ù‚ÙŠ",
     "ØªÙˆÙƒÙŠÙ„Ø§Øª Ø§Ù„Ø¬Ø²ÙŠØ±Ù‡",
     "Ø§Ù„Ù…Ù‡Ø±ÙŠ",
     "Ø¨ÙŠØª Ø§Ù„ØªØ²Ø§Ù…Ù†",
     "Ø§Ù„ÙˆØ§Ù† Ø§Ù„Ø¹Ø±Ø¨Ù‡",
     "Ø³Ø§Ù…Ø§ÙƒÙˆ",
     "ØªØ´Ù„ÙŠØ­ Ø§Ù„Ø­Ø§Ø¦Ø±",
     "Ø§Ù„Ø­Ø§Ø¬ Ø­Ø³ÙŠÙ†",
     "Ø§Ù„Ù…ØºÙ„ÙˆØ«",
     "Ø§Ù‡Ù„ Ø§Ù„Ø®Ø¨Ø±Ø©",
     "Ø§ÙˆØªÙˆØ¨Ø§Ù†ÙˆØ±Ø§Ù…Ø§",
     "Ø´Ù…Ø³ Ø§Ù„Ø§ØµÙ†Ø§Ù",
     "Ø¶ÙŠØ§Ø¡ Ø§Ù„Ø¨Ø´Ø§Ø¦Ø±",
     "Ù…ØµØ¯Ø± Ø§Ù„Ø²ÙŠÙˆØª",
     "Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„ÙƒØ¨ÙŠØ±",
     "Ø§Ù„ÙˆØ¹Ù„Ø§Ù†",
     "Ø±ÙŠÙ†ÙŠÙˆ(ÙˆÙƒÙŠÙ„ Ø±ÙŠÙ†ÙŠÙˆ Ø§Ù„Ø³Ø§Ø¨Ù‚)",
     "Ø§Ù…Ø¨ÙˆØ¨Ù‡",
     "Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠ",
     "Ù…Ù†ÙŠÙ Ø§Ù„Ù†Ù‡Ø¯ÙŠ",
     "Ù…Ù†ÙŠÙ Ø§Ù„Ù†Ù‡Ø¯ÙŠ",
     "Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ",
     "Ø§Ù„Ù†Ø§ØºÙŠ",
     "Ù†Ø¬Ù…Ø© Ù†ÙŠØ³Ø§Ù†"
]

# ğŸ“ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø£Ø³Ù…Ø§Ø¡
supplier_locations = [
 "24.647411671633186, 46.733357823156254",
 "24.845732140510165, 46.83772791388598",
 "24.71497611459734, 46.85154226441841",
 "24.63525338912695, 46.75119129325291",
 "24.638851840518754, 46.75381729726751",
 "24.640334226653497, 46.73701425831106",
 "24.63763632960209, 46.69798201413471",
 "24.639905494636505, 46.73870507180525",
 "24.588637127160855, 46.741808973652155",
 "24.639102492055553, 46.74293732393508",
 "24.637583781783757, 46.73997505092344",
 "24.75728130813972, 46.83698455359912",
 "24.530028461748053, 46.796529139290044",
 "24.71097985325633, 46.76433549578683",
 "24.639066392114753, 46.74375391541574",
 "24.63080492161978, 46.80019008473356",
 "24.633886795771236, 46.74362784851069",
 "24.632542240204977, 46.7439049387103",
 "24.63077313179229, 46.743776101921554",
 "24.79685957045473, 46.87668998286495",
 "24.630906868750436, 46.739725062004865",
 "24.755653000336398, 46.681146804334325",
 "24.643137492893977, 46.74280038085473",
 "24.692337824277736, 46.85420735771145",
 "24.63060854261958, 46.742010002487426",
 "24.635681945385517, 46.74341183459995",
 "24.58540762379448, 46.686121521522324",
 "24.77369655611179, 46.67640812152232",
 "24.630372368751107, 46.74131737734596",
 "24.63726862141617, 46.738920898227754"

]

# ğŸ—ï¸ ØªÙ‡ÙŠØ¦Ø© DataFrame ÙØ§Ø±Øº Ø¨Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†
distance_matrix = pd.DataFrame(index=supplier_names, columns=supplier_names)

# ğŸ” Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ø§Øª Ù„ÙƒÙ„ Ø²ÙˆØ¬ Ù…Ù† Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø¨Ø´ÙƒÙ„ Ù…Ø¬Ø²Ø£ Ù„ØªØ¬Ù†Ø¨ ØªØ¬Ø§ÙˆØ² Ø­Ø¯ÙˆØ¯ ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª
chunk_size = 10  # Ø­Ø¬Ù… ÙƒÙ„ Ø¬Ø²Ø¡ (10x10 = 100 Ø¹Ù†ØµØ±ØŒ ÙˆÙ‡Ùˆ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰)

for i in range(0, len(supplier_locations), chunk_size):
    origins_chunk = supplier_locations[i:i + chunk_size]
    
    for j in range(0, len(supplier_locations), chunk_size):
        destinations_chunk = supplier_locations[j:j + chunk_size]
        
        result = gmaps.distance_matrix(origins=origins_chunk,
                                       destinations=destinations_chunk,
                                       mode='driving')
        
        for k, row in enumerate(result['rows']):
            origin_index = i + k
            for l, element in enumerate(row['elements']):
                destination_index = j + l
                try:
                    distance_meters = element['distance']['value']
                    distance_km = round(distance_meters / 1000, 2)
                    distance_matrix.iloc[origin_index, destination_index] = distance_km
                except (KeyError, IndexError):
                    distance_matrix.iloc[origin_index, destination_index] = None

# ï¿½ï¿½ Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙÙŠ Ù…Ù„Ù Excel
output_path = r"E:\distances.xlsx"
distance_matrix.to_excel(output_path, encoding="utf-8-sig")
print(distance_matrix)
print(f"File saved to: {output_path}")

